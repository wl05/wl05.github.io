(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{518:function(e,r,t){e.exports=t.p+"assets/img/prometheus_architecture.cd3a82de.png"},572:function(e,r,t){"use strict";t.r(r);var s=t(14),a=Object(s.a)({},(function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"promethus"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#promethus"}},[e._v("#")]),e._v(" Promethus")]),e._v(" "),s("h2",{attrs:{id:"简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[e._v("#")]),e._v(" 简介")]),e._v(" "),s("h2",{attrs:{id:"promethus-架构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#promethus-架构"}},[e._v("#")]),e._v(" Promethus 架构")]),e._v(" "),s("p",[s("img",{attrs:{src:t(518),alt:"prometheus_architecture"}})]),e._v(" "),s("p",[e._v("下面对Promethus的核心组件进行介绍")]),e._v(" "),s("h3",{attrs:{id:"prometheus-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prometheus-server"}},[e._v("#")]),e._v(" Prometheus Server")]),e._v(" "),s("p",[e._v("Prometheus Server是Prometheus组件中的核心部分，负责实现对监控数据的获取，存储以及查询。 Prometheus Server可以通过静态配置管理监控目标，也可以配合使用Service Discovery的方式动态管理监控目标，并从这些监控目标中获取数据。其次Prometheus Server需要对采集到的监控数据进行存储，Prometheus Server本身就是一个时序数据库，将采集到的监控数据按照时间序列的方式存储在本地磁盘当中。最后Prometheus Server对外提供了自定义的PromQL语言，实现对数据的查询以及分析。\nPrometheus Server内置的Express Browser UI，通过这个UI可以直接通过PromQL实现数据的查询以及可视化。\nPrometheus Server的联邦集群能力可以使其从其他的Prometheus Server实例中获取数据，因此在大规模监控的情况下，可以通过联邦集群以及功能分区的方式对Prometheus Server进行扩展。")]),e._v(" "),s("h3",{attrs:{id:"exporters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#exporters"}},[e._v("#")]),e._v(" Exporters")]),e._v(" "),s("p",[e._v("Exporter将监控数据采集的端点通过HTTP服务的形式暴露给Prometheus Server，Prometheus Server通过访问该Exporter提供的Endpoint端点，即可获取到需要采集的监控数据。\n一般来说可以将Exporter分为2类：")]),e._v(" "),s("ul",[s("li",[e._v("直接采集：这一类Exporter直接内置了对Prometheus监控的支持，比如cAdvisor，Kubernetes，Etcd，Gokit等，都直接内置了用于向Prometheus暴露监控数据的端点。")]),e._v(" "),s("li",[e._v("间接采集：间接采集，原有监控目标并不直接支持Prometheus，因此我们需要通过Prometheus提供的Client Library编写该监控目标的监控采集程序。例如： Mysql Exporter，JMX Exporter，Consul Exporter等。")])]),e._v(" "),s("h3",{attrs:{id:"alertmanager"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#alertmanager"}},[e._v("#")]),e._v(" AlertManager")]),e._v(" "),s("p",[e._v("在Prometheus Server中支持基于PromQL创建告警规则，如果满足PromQL定义的规则，则会产生一条告警，而告警的后续处理流程则由AlertManager进行管理。在AlertManager中我们可以与邮件，Slack等等内置的通知方式进行集成，也可以通过Webhook自定义告警处理方式。AlertManager即Prometheus体系中的告警处理中心。")]),e._v(" "),s("h3",{attrs:{id:"pushgateway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pushgateway"}},[e._v("#")]),e._v(" PushGateway")]),e._v(" "),s("p",[e._v("由于Prometheus数据采集基于Pull模型进行设计，因此在网络环境的配置上必须要让Prometheus Server能够直接与Exporter进行通信。 当这种网络需求无法直接满足时，就可以利用PushGateway来进行中转。可以通过PushGateway将内部网络的监控数据主动Push到Gateway当中。而Prometheus Server则可以采用同样Pull的方式从PushGateway中获取到监控数据")]),e._v(" "),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[e._v("#")]),e._v(" 安装")]),e._v(" "),s("p",[e._v("Prometheus是一个开放性的监控解决方案，用户可以非常方便的安装和使用Prometheus并且能够非常方便的对其进行扩展。为了能够更加直观的了解Prometheus Server，接下来我们将在本地部署并运行一个Prometheus Server实例，通过Node Exporter采集当前主机的系统资源使用情况。 并通过Grafana创建一个简单的可视化仪表盘。")]),e._v(" "),s("p",[e._v("Prometheus基于Golang编写，编译后的软件包，不依赖于任何的第三方依赖。用户只需要下载对应平台的二进制包，解压并且添加基本的配置即可正常启动Prometheus Server。可以从"),s("a",{attrs:{href:"https://prometheus.io/download/%E6%89%BE%E5%88%B0%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%E7%9A%84Prometheus",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://prometheus.io/download/找到最新版本的Prometheus"),s("OutboundLink")],1),e._v(" Sevrer软件包。这里为了推荐使用docker进行安装，方便快捷。")]),e._v(" "),s("p",[e._v("对于Docker用户，直接使用Prometheus的镜像即可启动Prometheus Server：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("docker run -p 9090:9090 -v /etc/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml prom/prometheus\n")])])]),s("p",[e._v("启动完成后，可以通过"),s("a",{attrs:{href:"http://localhost:9090/%E8%AE%BF%E9%97%AEPrometheus%E7%9A%84UI",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:9090/访问Prometheus的UI"),s("OutboundLink")],1),e._v("界面。")])])}),[],!1,null,null,null);r.default=a.exports}}]);