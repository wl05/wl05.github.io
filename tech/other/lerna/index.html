<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>lerna 简单入门 | ANT 记录</title>
    <meta name="generator" content="VuePress 1.8.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.9735c5ed.css" as="style"><link rel="preload" href="/assets/js/app.20c2ee50.js" as="script"><link rel="preload" href="/assets/js/2.c1155b6d.js" as="script"><link rel="preload" href="/assets/js/20.4c13fb15.js" as="script"><link rel="prefetch" href="/assets/js/10.c7c7f8ce.js"><link rel="prefetch" href="/assets/js/11.0d6bac72.js"><link rel="prefetch" href="/assets/js/12.8afbadb5.js"><link rel="prefetch" href="/assets/js/13.01026307.js"><link rel="prefetch" href="/assets/js/14.82187de3.js"><link rel="prefetch" href="/assets/js/15.5b47a5f0.js"><link rel="prefetch" href="/assets/js/16.476c50b4.js"><link rel="prefetch" href="/assets/js/17.5daaea42.js"><link rel="prefetch" href="/assets/js/18.706c1768.js"><link rel="prefetch" href="/assets/js/19.6c1f89ef.js"><link rel="prefetch" href="/assets/js/21.c6269d6e.js"><link rel="prefetch" href="/assets/js/22.c820989f.js"><link rel="prefetch" href="/assets/js/23.63465ece.js"><link rel="prefetch" href="/assets/js/24.06b57371.js"><link rel="prefetch" href="/assets/js/25.7631169a.js"><link rel="prefetch" href="/assets/js/26.4dc21ad2.js"><link rel="prefetch" href="/assets/js/27.54fa8ac9.js"><link rel="prefetch" href="/assets/js/28.6da2f6ba.js"><link rel="prefetch" href="/assets/js/29.3b84b498.js"><link rel="prefetch" href="/assets/js/3.141a0dde.js"><link rel="prefetch" href="/assets/js/30.1a3ca712.js"><link rel="prefetch" href="/assets/js/31.acd6e9fc.js"><link rel="prefetch" href="/assets/js/32.723921de.js"><link rel="prefetch" href="/assets/js/33.a94aabaa.js"><link rel="prefetch" href="/assets/js/34.62d9f9bd.js"><link rel="prefetch" href="/assets/js/35.e10da7db.js"><link rel="prefetch" href="/assets/js/36.2af7bc62.js"><link rel="prefetch" href="/assets/js/37.4b21dee5.js"><link rel="prefetch" href="/assets/js/38.e2d5de64.js"><link rel="prefetch" href="/assets/js/39.2eb5e8df.js"><link rel="prefetch" href="/assets/js/4.eae85375.js"><link rel="prefetch" href="/assets/js/40.ff2190ac.js"><link rel="prefetch" href="/assets/js/41.dabde94f.js"><link rel="prefetch" href="/assets/js/42.e828286c.js"><link rel="prefetch" href="/assets/js/43.3f457a35.js"><link rel="prefetch" href="/assets/js/44.4bec6806.js"><link rel="prefetch" href="/assets/js/45.97848f66.js"><link rel="prefetch" href="/assets/js/46.e39b9931.js"><link rel="prefetch" href="/assets/js/47.b2acc87c.js"><link rel="prefetch" href="/assets/js/48.563cda9b.js"><link rel="prefetch" href="/assets/js/49.655ed33a.js"><link rel="prefetch" href="/assets/js/5.ffb4c2e6.js"><link rel="prefetch" href="/assets/js/50.b7089005.js"><link rel="prefetch" href="/assets/js/51.7afad35d.js"><link rel="prefetch" href="/assets/js/52.662feafb.js"><link rel="prefetch" href="/assets/js/53.3fdefaf4.js"><link rel="prefetch" href="/assets/js/54.33563143.js"><link rel="prefetch" href="/assets/js/55.710846f9.js"><link rel="prefetch" href="/assets/js/56.fa788c67.js"><link rel="prefetch" href="/assets/js/57.4a4c8c91.js"><link rel="prefetch" href="/assets/js/58.7ba84d41.js"><link rel="prefetch" href="/assets/js/59.120a50b4.js"><link rel="prefetch" href="/assets/js/6.2f7d43a4.js"><link rel="prefetch" href="/assets/js/60.2f515221.js"><link rel="prefetch" href="/assets/js/61.989f1a26.js"><link rel="prefetch" href="/assets/js/62.fa58cc14.js"><link rel="prefetch" href="/assets/js/63.1d358350.js"><link rel="prefetch" href="/assets/js/64.d0364210.js"><link rel="prefetch" href="/assets/js/65.76c255d8.js"><link rel="prefetch" href="/assets/js/66.eb35b1f0.js"><link rel="prefetch" href="/assets/js/67.cbb59cf4.js"><link rel="prefetch" href="/assets/js/68.87e1d5ac.js"><link rel="prefetch" href="/assets/js/69.b381f19d.js"><link rel="prefetch" href="/assets/js/7.8967d374.js"><link rel="prefetch" href="/assets/js/70.e3c585a6.js"><link rel="prefetch" href="/assets/js/71.3edfa114.js"><link rel="prefetch" href="/assets/js/72.c62193a8.js"><link rel="prefetch" href="/assets/js/73.77b6f4c3.js"><link rel="prefetch" href="/assets/js/74.6bc3b1ad.js"><link rel="prefetch" href="/assets/js/75.33de0318.js"><link rel="prefetch" href="/assets/js/76.68d2091e.js"><link rel="prefetch" href="/assets/js/77.09803a86.js"><link rel="prefetch" href="/assets/js/78.7885c20b.js"><link rel="prefetch" href="/assets/js/79.1259283d.js"><link rel="prefetch" href="/assets/js/8.3ae08917.js"><link rel="prefetch" href="/assets/js/80.f1ace99b.js"><link rel="prefetch" href="/assets/js/81.0b6d3cb6.js"><link rel="prefetch" href="/assets/js/82.ac9a1f6e.js"><link rel="prefetch" href="/assets/js/83.2a6a4121.js"><link rel="prefetch" href="/assets/js/84.94358229.js"><link rel="prefetch" href="/assets/js/85.114c0bd5.js"><link rel="prefetch" href="/assets/js/86.fa5e0792.js"><link rel="prefetch" href="/assets/js/87.97272018.js"><link rel="prefetch" href="/assets/js/88.b625a5c7.js"><link rel="prefetch" href="/assets/js/89.0609b7ac.js"><link rel="prefetch" href="/assets/js/9.2cd02ca5.js"><link rel="prefetch" href="/assets/js/90.6427032f.js"><link rel="prefetch" href="/assets/js/91.df714f23.js"><link rel="prefetch" href="/assets/js/92.870c38d6.js"><link rel="prefetch" href="/assets/js/93.cc306042.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9735c5ed.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ANT 记录</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tech/css/css-box-model/" class="nav-link">
  技术
</a></div><div class="nav-item"><a href="/read/" class="nav-link">
  读书
</a></div> <a href="https://github.com/wl05/ant-site" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tech/css/css-box-model/" class="nav-link">
  技术
</a></div><div class="nav-item"><a href="/read/" class="nav-link">
  读书
</a></div> <a href="https://github.com/wl05/ant-site" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/css/css-box-model/" class="sidebar-link">CSS 盒模型</a></li><li><a href="/tech/css/css-bfc/" class="sidebar-link">BFC</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/javascript/" class="sidebar-link">知识点参考</a></li><li><a href="/tech/javascript/js-data-type/" class="sidebar-link">Javascript 数据类型</a></li><li><a href="/tech/javascript/js-type-judge/" class="sidebar-link">Javascript 类型判断</a></li><li><a href="/tech/javascript/js-type-convert/" class="sidebar-link">Javascript 类型转换</a></li><li><a href="/tech/javascript/js-this/" class="sidebar-link">Javascript this 理解</a></li><li><a href="/tech/javascript/js-closure/" class="sidebar-link">Javascript 闭包</a></li><li><a href="/tech/javascript/ast/" class="sidebar-link">玩转AST</a></li><li><a href="/tech/javascript/event-loop/" class="sidebar-link">Event Loop</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Typescript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/typescript/basic-type/" class="sidebar-link">Typescript 基础类型</a></li><li><a href="/tech/typescript/type-manipulation/generics.html" class="sidebar-link">泛型</a></li><li><a href="/tech/typescript/function/" class="sidebar-link">函数类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/browser/1-chrome-browser-architecture/" class="sidebar-link">1、Chrome浏览器架构</a></li><li><a href="/tech/browser/2-what-happens-in-navigation/" class="sidebar-link">2、导航过程发生了什么</a></li><li><a href="/tech/browser/3-inner-workings-of-a-renderer-process/" class="sidebar-link">3、渲染进程工作过程</a></li><li><a href="/tech/browser/4-input-is-coming-to-the-compositor/" class="sidebar-link">4、到达合成线程的输入</a></li><li><a href="/tech/browser/how-v8-works/" class="sidebar-link">JS引擎工作原理详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端性能优化</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/framework/react/create-your-own-react/" class="sidebar-link">手写 React</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>设计模式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/design-patterns/" class="sidebar-link">TODO</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>web 安全</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/web-security/xss/" class="sidebar-link">XSS 攻击</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>git</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/git/git-base.html" class="sidebar-link">git 命令总结</a></li><li><a href="/tech/git/git-rebase/" class="sidebar-link">git rebase 详解</a></li><li><a href="/tech/git/git-config.html" class="sidebar-link">git 命令别名配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>算法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/algorithm/leetcode/" class="sidebar-link">leetcode 热门题目</a></li><li><a href="/tech/algorithm/leetcode/dynamic-programming.html" class="sidebar-link">动态规划</a></li><li><a href="/tech/algorithm/leetcode/greedy-algorithm.html" class="sidebar-link">贪心算法</a></li><li><a href="/tech/algorithm/leetcode/bfs.html" class="sidebar-link">BFS （广度优先遍历）</a></li><li><a href="/tech/algorithm/leetcode/dfs.html" class="sidebar-link">DFS （深度优先遍历）</a></li><li><a href="/tech/algorithm/sort-algorithm/bubble-sort.html" class="sidebar-link">冒泡算法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端监控</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/monitor/monitor/" class="sidebar-link">搭建前端监控系统</a></li><li><a href="/tech/monitor/data-visualization/histogram/" class="sidebar-link">直方图 （Histogram）</a></li><li><a href="/tech/monitor/data-visualization/1/" class="sidebar-link">1. Promethus 介绍</a></li><li><a href="/tech/monitor/data-visualization/2/" class="sidebar-link">2. Exporter 实战详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React Native</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/react-native/webview/" class="sidebar-link">RN Webview 内嵌h5方案调研</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>思考</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/think/2021-06-20.html" class="sidebar-link">抬头看路</a></li><li><a href="/tech/think/2022-02-14.html" class="sidebar-link">被几个月代理leader</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/other/abort-request.html" class="sidebar-link">终止异步任务</a></li><li><a href="/tech/other/cicd-concepts.html" class="sidebar-link">CI/CD 概念</a></li><li><a href="/tech/other/flow-chart.html" class="sidebar-link">流程图规范</a></li><li><a href="/tech/other/google-search.html" class="sidebar-link">google 搜索技巧</a></li><li><a href="/tech/other/how-to-output-log.html" class="sidebar-link">参考资料</a></li><li><a href="/tech/other/linux-command.html" class="sidebar-link">linux 常用命令</a></li><li><a href="/tech/other/sketchup.html" class="sidebar-link">SketchUp 基础入门</a></li><li><a href="/tech/other/docker/docker-introduction/" class="sidebar-link">Docker 浅尝辄止</a></li><li><a href="/tech/other/lerna/" aria-current="page" class="active sidebar-link">lerna 简单入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tech/other/lerna/#为什么要使用-lerna" class="sidebar-link">为什么要使用 lerna</a></li><li class="sidebar-sub-header"><a href="/tech/other/lerna/#如何使用-lerna" class="sidebar-link">如何使用 Lerna</a></li><li class="sidebar-sub-header"><a href="/tech/other/lerna/#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/tech/other/lerna/#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/tech/other/npm/" class="sidebar-link">重新认识 npm</a></li><li><a href="/tech/other/svg/" class="sidebar-link">svg 不完全入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>面试</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/interview/handwritten-topic.html" class="sidebar-link">前端手写题</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="lerna-简单入门"><a href="#lerna-简单入门" class="header-anchor">#</a> lerna 简单入门</h1> <p><img src="/assets/img/79596653-38f81200-80e1-11ea-98cd-1c6a3bb5de51.d0b5c1e5.png" alt=""></p> <p>本篇将围绕<strong>为什么要使用 lerna</strong>以及<strong>如何使用 lerna</strong> 两个方面来认识 lerna。</p> <h2 id="为什么要使用-lerna"><a href="#为什么要使用-lerna" class="header-anchor">#</a> 为什么要使用 lerna</h2> <p>先来看下官方的解释：</p> <blockquote><ul><li>Splitting up large codebases into separate independently versioned packages is extremely useful for code sharing. However, making changes across many repositories is messy and difficult to track, and testing across repositories becomes complicated very quickly.</li> <li>To solve these (and many other) problems, some projects will organize their codebases into multi-package repositories (sometimes called monorepos). Projects like Babel, React, Angular, Ember, Meteor, Jest, and many others develop all of their packages within a single repository.</li> <li>Lerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.</li> <li>Lerna can also reduce the time and space requirements for numerous copies of packages in development and build environments - normally a downside of dividing a project into many separate NPM packages. See the hoist documentation for details.</li></ul></blockquote> <p>意思就是说我们开发的一些项目存在相互依赖的情况，同时呢这些项目又是在不同的仓库里面，这就给开发、维护和测试带来了极大的困难。
为了解决这些问题，一些项目就把这些相互依赖的项目组织成多包的形式放在同一个代码仓库里面（俗称 monorepos）。
Babel, React, Angular, Ember, Meteor, Jest 等都是将它们的包放在同一个仓库中来维护的。
Lerna干的事情就是使用 git 和 npm 来优化多包库的管理工作流程。</p> <h2 id="如何使用-lerna"><a href="#如何使用-lerna" class="header-anchor">#</a> 如何使用 Lerna</h2> <h3 id="lerna-管理项目的模式"><a href="#lerna-管理项目的模式" class="header-anchor">#</a> Lerna 管理项目的模式</h3> <p>Lerna 有两种管理项目的模式：</p> <ul><li><p>Fixed/Locked 模式 (默认)： 所有的包共用一个版本号。</p></li> <li><p>Independent mode： 在初始化的时候指定 --independent 参数：</p></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>lerna init --independent
</code></pre></div><p>这种模式下，可以单独的为每个包指定版本号。</p> <p>learn为我们提供了以下命令：</p> <ul><li>lerna publish</li> <li>lerna version</li> <li>lerna bootstrap</li> <li>lerna list</li> <li>lerna changed</li> <li>lerna diff</li> <li>lerna exec</li> <li>lerna run</li> <li>lerna init</li> <li>lerna add</li> <li>lerna clean</li> <li>lerna import</li> <li>lerna link</li> <li>lerna create</li> <li>lerna info</li></ul> <p>下面通过具体的demo来使用一下这些命令。</p> <h3 id="lerna-init"><a href="#lerna-init" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/init#readme" target="_blank" rel="noopener noreferrer">lerna init<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：初始化项目</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 采用独立模式</span>
$ <span class="token function">mkdir</span> lerna-example <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> <span class="token variable">$_</span> <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> <span class="token function">install</span> lerna -D <span class="token operator">&amp;&amp;</span> npx lerna init --independent
</code></pre></div><p>生成的项目目录如下：</p> <div class="language- extra-class"><pre class="language-text"><code>lerna-example/
  packages/
  package.json
  lerna.json
</code></pre></div><p>lerna.json 各个字段的含义：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.1.3&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;npmClient&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;publish&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;ignoreChanges&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;ignored-file&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*.md&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;chore(release): publish&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://npm.pkg.github.com&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;bootstrap&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;ignore&quot;</span><span class="token operator">:</span> <span class="token string">&quot;component-*&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;npmClientArgs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;--no-package-lock&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;packages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;packages/*&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>version: 当前项目的版本，如果是independent模式的话这里是 &quot;independent&quot; 字符串</li> <li>npmClient: 默认是 npm，可以使用yarn</li> <li>command.publish.ignoreChanges: 指定哪些文件的更新不需要发布，例如修改 README。</li> <li>command.publish.message: 在发版更新 version 的时候指定自定义 commit message</li> <li>command.publish.registry: 指定远程仓库</li> <li>command.bootstrap.ignore: 执行 lerna bootstrap 时忽略的文件</li> <li>command.bootstrap.npmClientArgs: 执行 lerna bootstrap 命令会去执行 npm install 这里的参数就是传递给 npm install 的。</li> <li>command.bootstrap.scope: 决定在执行 lerna bootstrap 的时候哪些 package 需要 bootstrap</li> <li>packages: 指定 package 存放的位置</li></ul> <p>现在我们的 packages 下面什么都还没有，下面我们来创建一些包。</p> <h3 id="lerna-create"><a href="#lerna-create" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/create#readme" target="_blank" rel="noopener noreferrer">lerna create<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：通过 lerna create 创建一个新的包，当然你也可以手动创建</p> <div class="language-bash extra-class"><pre class="language-bash"><code>lerna create animal
lerna create <span class="token function">cat</span> 
lerna create dog
</code></pre></div><p>这里我们创建了animal cat dog 三个包项目结构如下:</p> <div class="language- extra-class"><pre class="language-text"><code>.
├── lerna.json
├── package.json
└── packages
    ├── animal
    │   ├── README.md
    │   ├── __tests__
    │   │   └── animal.test.js
    │   ├── lib
    │   │   └── animal.js
    │   └── package.json
    ├── cat
    │   ├── README.md
    │   ├── __tests__
    │   │   └── cat.test.js
    │   ├── lib
    │   │   └── cat.js
    │   └── package.json
    └── dog
        ├── README.md
        ├── __tests__
        │   └── dog.test.js
        ├── lib
        │   └── dog.js
        └── package.json
</code></pre></div><h3 id="lerna-add"><a href="#lerna-add" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/add#readme" target="_blank" rel="noopener noreferrer">lerna add<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：learn add 添加本地包或者远程包作为包的依赖</p> <div class="language- extra-class"><pre class="language-text"><code># 向名字以 prefix- 为前缀的文件夹里面添加 module-1 作为依赖
$ lerna add module-1 packages/prefix-*

# 向 module-2 中添加 module-1 作为依赖
$ lerna add module-1 --scope=module-2

# 向 module-2 中添加 module-1 作为开发依赖（devDependencies）
$ lerna add module-1 --scope=module-2 --dev

# 向 module-2 中添加 module-1 作为peerDependencies
$ lerna add module-1 --scope=module-2 --peer

# 向除了module-1（因为 module-1 是本地包）的所有包中添加 module-1 作为依赖
$ lerna add module-1

# 向所有的包中添加 babel-core 作为依赖（ babel-core 是远程包）
$ lerna add babel-core
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code># 添加的 animal 作为 dog、cat 的依赖
$ lerna add animal 
</code></pre></div><p>查看 dog 或者 cat 的 dependencies 会看到加入的依赖 animal。</p> <h3 id="lerna-version"><a href="#lerna-version" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/version#readme" target="_blank" rel="noopener noreferrer">lerna version<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：发布前更新包的版本 （lerna publish 包含这一步）</p> <p>用法：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>lerna version <span class="token number">1.0</span>.1 <span class="token comment"># 直接指定特定的版本</span>
lerna version patch <span class="token comment"># 使用语义关键字</span>
lerna version       <span class="token comment"># 通过交互式命令选择</span>
</code></pre></div><p>lerna version 在背后为我们做了这些事：</p> <ol><li>识别出自上次发布以后更新过的包；</li> <li>提示选择新版本；</li> <li>修改包的元数据来反映最新发版（修改包的版本号），在根目录和每个包里面运行生命周期脚本；</li> <li>对提交打 tag；</li> <li>推送到远程代码仓库。</li></ol> <p>先 commit 本地的改动，然后执行 lerna version，默认情况下 lerna version 会将本地的 commit 和 tag 推送到远程仓库，这里只是本地演示可以通过指定 --no-push 参数来禁止推送。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ lerna version --no-push
info cli using <span class="token builtin class-name">local</span> version of lerna
lerna notice cli v4.0.0
lerna info versioning independent
lerna info Looking <span class="token keyword">for</span> changed packages since animal@1.0.1
? Select a new version <span class="token keyword">for</span> <span class="token function">cat</span> <span class="token punctuation">(</span>currently <span class="token number">1.0</span>.0<span class="token punctuation">)</span> <span class="token punctuation">(</span>Use arrow keys<span class="token punctuation">)</span>
❯ Patch <span class="token punctuation">(</span><span class="token number">1.0</span>.1<span class="token punctuation">)</span> 
  Minor <span class="token punctuation">(</span><span class="token number">1.1</span>.0<span class="token punctuation">)</span> 
  Major <span class="token punctuation">(</span><span class="token number">2.0</span>.0<span class="token punctuation">)</span> 
  Prepatch <span class="token punctuation">(</span><span class="token number">1.0</span>.1-alpha.0<span class="token punctuation">)</span> 
  Preminor <span class="token punctuation">(</span><span class="token number">1.1</span>.0-alpha.0<span class="token punctuation">)</span> 
  Premajor <span class="token punctuation">(</span><span class="token number">2.0</span>.0-alpha.0<span class="token punctuation">)</span> 
  Custom Prerelease 
  Custom Version 
<span class="token punctuation">..</span>.
</code></pre></div><h3 id="lerna-publish"><a href="#lerna-publish" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/publish#readme" target="_blank" rel="noopener noreferrer">lerna publish<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用： 发布本地包</p> <p>用法：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#发布自上次发布过后更新过的包 （背后会执行 lerna version）</span>
$ lerna publish 
<span class="token comment">#发布当前通过 lerna version 打好 tag 的包，需要先使用 lerna version 更新版本</span>
$ lerna publish from-git
<span class="token comment">#只发布远程 npm 仓库中没有的版本，适用于 lerna publish 没有全部发布成功的场景。</span>
$ lerna publish from-package
</code></pre></div><p>为了真实地模拟发包过程这里我们使用 <a href="https://verdaccio.org/" target="_blank" rel="noopener noreferrer">Verdaccio<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 搭建一个本地 npm 仓库</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 全局安装</span>
$ <span class="token function">npm</span> <span class="token function">install</span> -g verdaccio
$ verdaccio
</code></pre></div><p>访问 <code>http://localhost:4873/</code> 可以看到启动界面。</p> <ul><li><p>将每个包 package.json 中的 publishConfig.registry 改为 <code>http://localhost:4873/</code></p></li> <li><p>或者在项目的根目录创建 .npmrc 文件，将 npm 仓库地址改写为本地仓库地址： <code>registry=&quot;http://localhost:4873/&quot;</code>，注意将每个包 package.json 中的 publishConfig 字段去掉</p></li></ul> <p>在 dog.js 中添加一行 <code>console.log(&quot;bark&quot;)</code>,准备就绪后 commit 提交本地的修改，然后执行：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ lerna publish --no-push
info cli using <span class="token builtin class-name">local</span> version of lerna
lerna notice cli v4.0.0
lerna info versioning independent
lerna info Looking <span class="token keyword">for</span> changed packages since cat@1.0.3
? Select a new version <span class="token keyword">for</span> dog <span class="token punctuation">(</span>currently <span class="token number">1.0</span>.4<span class="token punctuation">)</span> <span class="token punctuation">(</span>Use arrow keys<span class="token punctuation">)</span>
❯ Patch <span class="token punctuation">(</span><span class="token number">1.0</span>.5<span class="token punctuation">)</span> 
  Minor <span class="token punctuation">(</span><span class="token number">1.1</span>.0<span class="token punctuation">)</span> 
  Major <span class="token punctuation">(</span><span class="token number">2.0</span>.0<span class="token punctuation">)</span> 
  Prepatch <span class="token punctuation">(</span><span class="token number">1.0</span>.5-alpha.0<span class="token punctuation">)</span> 
  Preminor <span class="token punctuation">(</span><span class="token number">1.1</span>.0-alpha.0<span class="token punctuation">)</span> 
  Premajor <span class="token punctuation">(</span><span class="token number">2.0</span>.0-alpha.0<span class="token punctuation">)</span> 
  Custom Prerelease 
  Custom Version 
<span class="token punctuation">..</span>.
</code></pre></div><p>命令行中会让我们进行版本的选择和确认，确认完毕后就会将我们的包发布到 npm 仓库中。</p> <p>刷新 <code>http://localhost:4873/</code> 就可以看到我们刚刚发布的包了。</p> <h3 id="lerna-list"><a href="#lerna-list" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/list#readme" target="_blank" rel="noopener noreferrer">lerna list<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：列出所有的本地包</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ lerna list      
info cli using <span class="token builtin class-name">local</span> version of lerna
lerna notice cli v4.0.0
lerna info versioning independent
animal
<span class="token function">cat</span>
dog
lerna success found <span class="token number">3</span> packages
</code></pre></div><h3 id="lerna-info"><a href="#lerna-info" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/info#readme" target="_blank" rel="noopener noreferrer">lerna info<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：打印出本地环境信息</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ lerna info   
info cli using <span class="token builtin class-name">local</span> version of lerna
lerna notice cli v4.0.0
lerna info versioning independent

 Environment info:

  System:
    OS: macOS <span class="token number">11.5</span>.2
    CPU: <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> x64 Intel<span class="token punctuation">(</span>R<span class="token punctuation">)</span> Core<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> i7-7920HQ CPU @ <span class="token number">3</span>.10GHz
  Binaries:
    Node: <span class="token number">14.16</span>.0 - ~/.nvm/versions/node/v14.16.0/bin/node
    Yarn: <span class="token number">1.22</span>.4 - ~/.yarn/bin/yarn
    npm: <span class="token number">6.14</span>.11 - ~/.nvm/versions/node/v14.16.0/bin/npm
  Utilities:
    Git: <span class="token number">2.24</span>.3 - /usr/bin/git
  npmPackages:
    lerna: ^4.0.0 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">4.0</span>.0 
</code></pre></div><h3 id="lerna-changed"><a href="#lerna-changed" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/changed#readme" target="_blank" rel="noopener noreferrer">lerna changed<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：列出自上一次发布过后修改过的包</p> <p>修改文件，执行命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ lerna changed   
info cli using <span class="token builtin class-name">local</span> version of lerna
lerna notice cli v4.0.0
lerna info versioning independent
lerna info Assuming all packages changed
animal
<span class="token function">cat</span>
dog
lerna success found <span class="token number">3</span> packages ready to publish
</code></pre></div><h3 id="lerna-clean"><a href="#lerna-clean" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/clean#readme" target="_blank" rel="noopener noreferrer">lerna clean<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：移除所有 package 下的 node_modules，除了根目录下的 node_modules</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ lerna clean               
info cli using <span class="token builtin class-name">local</span> version of lerna
lerna notice cli v4.0.0
lerna info versioning independent
lerna info Removing the following directories:
lerna info clean packages/animal/node_modules
lerna info clean packages/cat/node_modules
lerna info clean packages/dog/node_modules
? Proceed? Yes
<span class="token punctuation">..</span>.
</code></pre></div><h3 id="lerna-bootstrap"><a href="#lerna-bootstrap" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/bootstrap#readme" target="_blank" rel="noopener noreferrer">lerna bootstrap<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：建立相互依赖的包之间的软连接并安装其他的依赖</p> <p>这个命令在背后执行了以下步骤:</p> <ul><li>安装所有包的外部依赖</li> <li>建立存在依赖关系的包之间的依赖</li> <li>在 bootstrapped 的包中执行 npm run prepublish （没有指定 --ignore-prepublish 的情况下）</li> <li>在 bootstrapped 的包中执行npm run prepare</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ lerna bootstrap
info cli using <span class="token builtin class-name">local</span> version of lerna
lerna notice cli v4.0.0
lerna info versioning independent
lerna info Bootstrapping <span class="token number">3</span> packages
lerna info Symlinking packages and binaries
lerna success Bootstrapped <span class="token number">3</span> packages
</code></pre></div><h3 id="lerna-diff"><a href="#lerna-diff" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/diff#readme" target="_blank" rel="noopener noreferrer">lerna diff<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：列出包自上一次发版以来做出的修改。</p> <p>用法：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 列出所有包的改动</span>
$ lerna <span class="token function">diff</span> 
<span class="token comment"># 列出具体某个包的改动</span>
$ lerna <span class="token function">diff</span> package-name
</code></pre></div><h3 id="lerna-exec"><a href="#lerna-exec" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/exec#readme" target="_blank" rel="noopener noreferrer">lerna exec<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：使用 lerna exec 可以在所有的包目录下执行任意的命令。</p> <p>用法：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>lerna <span class="token builtin class-name">exec</span> -- <span class="token operator">&lt;</span>command<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">..</span>args<span class="token punctuation">]</span> <span class="token comment"># runs the command in all packages</span>
lerna <span class="token builtin class-name">exec</span> -- <span class="token function">rm</span> -rf ./node_modules <span class="token comment"># 删除所有包下面的 node_modules</span>
</code></pre></div><h3 id="lerna-run"><a href="#lerna-run" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/run#readme" target="_blank" rel="noopener noreferrer">lerna run<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：使用 lerna run 可以在所有的包目录下执行对应的脚本。</p> <p>用法：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>lerna run <span class="token builtin class-name">test</span> <span class="token comment"># 执行所有包的 test 命令</span>
</code></pre></div><h3 id="lerna-import"><a href="#lerna-import" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/import#readme" target="_blank" rel="noopener noreferrer">lerna import<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：将已经存在的项目作为一个包导入到现有的lerna项目中，同时项目的 commit 历史记录会被一并导入。</p> <p>用法：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>lerna <span class="token function">import</span> <span class="token operator">&lt;</span>path-to-external-repository<span class="token operator">&gt;</span>
</code></pre></div><h3 id="lerna-link"><a href="#lerna-link" class="header-anchor">#</a> <a href="https://github.com/lerna/lerna/tree/main/commands/link#readme" target="_blank" rel="noopener noreferrer">lerna link<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>作用：建立存在依赖关系的包之间的软连接</p> <p>用法：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>lerna <span class="token function">link</span>
</code></pre></div><h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>本篇对 lerna 管理多包项目的实践过程做了一些简单的讲解，做到基本入门应该问题不大，剩下的就自由发挥了 😊。</p> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li><a href="https://zhuanlan.zhihu.com/p/398080866" target="_blank" rel="noopener noreferrer">Lerna工作流探索<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://fed.taobao.org/blog/taofed/do71ct/uihagy/" target="_blank" rel="noopener noreferrer">All in one：项目级 monorepo 策略最佳实践<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844903856153821198" target="_blank" rel="noopener noreferrer">Lerna 中文教程详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://zhuanlan.zhihu.com/p/35237759" target="_blank" rel="noopener noreferrer">使用lerna优雅地管理多个package<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tech/other/docker/docker-introduction/" class="prev">
        Docker 浅尝辄止
      </a></span> <span class="next"><a href="/tech/other/npm/">
        重新认识 npm
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.20c2ee50.js" defer></script><script src="/assets/js/2.c1155b6d.js" defer></script><script src="/assets/js/20.4c13fb15.js" defer></script>
  </body>
</html>
