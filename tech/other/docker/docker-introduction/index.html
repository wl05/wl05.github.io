<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker 浅尝辄止 | ANT 记录</title>
    <meta name="generator" content="VuePress 1.8.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.9735c5ed.css" as="style"><link rel="preload" href="/assets/js/app.20c2ee50.js" as="script"><link rel="preload" href="/assets/js/2.c1155b6d.js" as="script"><link rel="preload" href="/assets/js/10.c7c7f8ce.js" as="script"><link rel="prefetch" href="/assets/js/11.0d6bac72.js"><link rel="prefetch" href="/assets/js/12.8afbadb5.js"><link rel="prefetch" href="/assets/js/13.01026307.js"><link rel="prefetch" href="/assets/js/14.82187de3.js"><link rel="prefetch" href="/assets/js/15.5b47a5f0.js"><link rel="prefetch" href="/assets/js/16.476c50b4.js"><link rel="prefetch" href="/assets/js/17.5daaea42.js"><link rel="prefetch" href="/assets/js/18.706c1768.js"><link rel="prefetch" href="/assets/js/19.6c1f89ef.js"><link rel="prefetch" href="/assets/js/20.4c13fb15.js"><link rel="prefetch" href="/assets/js/21.c6269d6e.js"><link rel="prefetch" href="/assets/js/22.c820989f.js"><link rel="prefetch" href="/assets/js/23.63465ece.js"><link rel="prefetch" href="/assets/js/24.06b57371.js"><link rel="prefetch" href="/assets/js/25.7631169a.js"><link rel="prefetch" href="/assets/js/26.4dc21ad2.js"><link rel="prefetch" href="/assets/js/27.54fa8ac9.js"><link rel="prefetch" href="/assets/js/28.6da2f6ba.js"><link rel="prefetch" href="/assets/js/29.3b84b498.js"><link rel="prefetch" href="/assets/js/3.141a0dde.js"><link rel="prefetch" href="/assets/js/30.1a3ca712.js"><link rel="prefetch" href="/assets/js/31.acd6e9fc.js"><link rel="prefetch" href="/assets/js/32.723921de.js"><link rel="prefetch" href="/assets/js/33.a94aabaa.js"><link rel="prefetch" href="/assets/js/34.62d9f9bd.js"><link rel="prefetch" href="/assets/js/35.e10da7db.js"><link rel="prefetch" href="/assets/js/36.2af7bc62.js"><link rel="prefetch" href="/assets/js/37.4b21dee5.js"><link rel="prefetch" href="/assets/js/38.e2d5de64.js"><link rel="prefetch" href="/assets/js/39.2eb5e8df.js"><link rel="prefetch" href="/assets/js/4.eae85375.js"><link rel="prefetch" href="/assets/js/40.ff2190ac.js"><link rel="prefetch" href="/assets/js/41.dabde94f.js"><link rel="prefetch" href="/assets/js/42.e828286c.js"><link rel="prefetch" href="/assets/js/43.3f457a35.js"><link rel="prefetch" href="/assets/js/44.4bec6806.js"><link rel="prefetch" href="/assets/js/45.97848f66.js"><link rel="prefetch" href="/assets/js/46.e39b9931.js"><link rel="prefetch" href="/assets/js/47.b2acc87c.js"><link rel="prefetch" href="/assets/js/48.563cda9b.js"><link rel="prefetch" href="/assets/js/49.655ed33a.js"><link rel="prefetch" href="/assets/js/5.ffb4c2e6.js"><link rel="prefetch" href="/assets/js/50.b7089005.js"><link rel="prefetch" href="/assets/js/51.7afad35d.js"><link rel="prefetch" href="/assets/js/52.662feafb.js"><link rel="prefetch" href="/assets/js/53.3fdefaf4.js"><link rel="prefetch" href="/assets/js/54.33563143.js"><link rel="prefetch" href="/assets/js/55.710846f9.js"><link rel="prefetch" href="/assets/js/56.fa788c67.js"><link rel="prefetch" href="/assets/js/57.4a4c8c91.js"><link rel="prefetch" href="/assets/js/58.7ba84d41.js"><link rel="prefetch" href="/assets/js/59.120a50b4.js"><link rel="prefetch" href="/assets/js/6.2f7d43a4.js"><link rel="prefetch" href="/assets/js/60.2f515221.js"><link rel="prefetch" href="/assets/js/61.989f1a26.js"><link rel="prefetch" href="/assets/js/62.fa58cc14.js"><link rel="prefetch" href="/assets/js/63.1d358350.js"><link rel="prefetch" href="/assets/js/64.d0364210.js"><link rel="prefetch" href="/assets/js/65.76c255d8.js"><link rel="prefetch" href="/assets/js/66.eb35b1f0.js"><link rel="prefetch" href="/assets/js/67.cbb59cf4.js"><link rel="prefetch" href="/assets/js/68.87e1d5ac.js"><link rel="prefetch" href="/assets/js/69.b381f19d.js"><link rel="prefetch" href="/assets/js/7.8967d374.js"><link rel="prefetch" href="/assets/js/70.e3c585a6.js"><link rel="prefetch" href="/assets/js/71.3edfa114.js"><link rel="prefetch" href="/assets/js/72.c62193a8.js"><link rel="prefetch" href="/assets/js/73.77b6f4c3.js"><link rel="prefetch" href="/assets/js/74.6bc3b1ad.js"><link rel="prefetch" href="/assets/js/75.33de0318.js"><link rel="prefetch" href="/assets/js/76.68d2091e.js"><link rel="prefetch" href="/assets/js/77.09803a86.js"><link rel="prefetch" href="/assets/js/78.7885c20b.js"><link rel="prefetch" href="/assets/js/79.1259283d.js"><link rel="prefetch" href="/assets/js/8.3ae08917.js"><link rel="prefetch" href="/assets/js/80.f1ace99b.js"><link rel="prefetch" href="/assets/js/81.0b6d3cb6.js"><link rel="prefetch" href="/assets/js/82.ac9a1f6e.js"><link rel="prefetch" href="/assets/js/83.2a6a4121.js"><link rel="prefetch" href="/assets/js/84.94358229.js"><link rel="prefetch" href="/assets/js/85.114c0bd5.js"><link rel="prefetch" href="/assets/js/86.fa5e0792.js"><link rel="prefetch" href="/assets/js/87.97272018.js"><link rel="prefetch" href="/assets/js/88.b625a5c7.js"><link rel="prefetch" href="/assets/js/89.0609b7ac.js"><link rel="prefetch" href="/assets/js/9.2cd02ca5.js"><link rel="prefetch" href="/assets/js/90.6427032f.js"><link rel="prefetch" href="/assets/js/91.df714f23.js"><link rel="prefetch" href="/assets/js/92.870c38d6.js"><link rel="prefetch" href="/assets/js/93.cc306042.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9735c5ed.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ANT 记录</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tech/css/css-box-model/" class="nav-link">
  技术
</a></div><div class="nav-item"><a href="/read/" class="nav-link">
  读书
</a></div> <a href="https://github.com/wl05/ant-site" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tech/css/css-box-model/" class="nav-link">
  技术
</a></div><div class="nav-item"><a href="/read/" class="nav-link">
  读书
</a></div> <a href="https://github.com/wl05/ant-site" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/css/css-box-model/" class="sidebar-link">CSS 盒模型</a></li><li><a href="/tech/css/css-bfc/" class="sidebar-link">BFC</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/javascript/" class="sidebar-link">知识点参考</a></li><li><a href="/tech/javascript/js-data-type/" class="sidebar-link">Javascript 数据类型</a></li><li><a href="/tech/javascript/js-type-judge/" class="sidebar-link">Javascript 类型判断</a></li><li><a href="/tech/javascript/js-type-convert/" class="sidebar-link">Javascript 类型转换</a></li><li><a href="/tech/javascript/js-this/" class="sidebar-link">Javascript this 理解</a></li><li><a href="/tech/javascript/js-closure/" class="sidebar-link">Javascript 闭包</a></li><li><a href="/tech/javascript/ast/" class="sidebar-link">玩转AST</a></li><li><a href="/tech/javascript/event-loop/" class="sidebar-link">Event Loop</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Typescript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/typescript/basic-type/" class="sidebar-link">Typescript 基础类型</a></li><li><a href="/tech/typescript/type-manipulation/generics.html" class="sidebar-link">泛型</a></li><li><a href="/tech/typescript/function/" class="sidebar-link">函数类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/browser/1-chrome-browser-architecture/" class="sidebar-link">1、Chrome浏览器架构</a></li><li><a href="/tech/browser/2-what-happens-in-navigation/" class="sidebar-link">2、导航过程发生了什么</a></li><li><a href="/tech/browser/3-inner-workings-of-a-renderer-process/" class="sidebar-link">3、渲染进程工作过程</a></li><li><a href="/tech/browser/4-input-is-coming-to-the-compositor/" class="sidebar-link">4、到达合成线程的输入</a></li><li><a href="/tech/browser/how-v8-works/" class="sidebar-link">JS引擎工作原理详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端性能优化</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/framework/react/create-your-own-react/" class="sidebar-link">手写 React</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>设计模式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/design-patterns/" class="sidebar-link">TODO</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>web 安全</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/web-security/xss/" class="sidebar-link">XSS 攻击</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>git</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/git/git-base.html" class="sidebar-link">git 命令总结</a></li><li><a href="/tech/git/git-rebase/" class="sidebar-link">git rebase 详解</a></li><li><a href="/tech/git/git-config.html" class="sidebar-link">git 命令别名配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>算法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/algorithm/leetcode/" class="sidebar-link">leetcode 热门题目</a></li><li><a href="/tech/algorithm/leetcode/dynamic-programming.html" class="sidebar-link">动态规划</a></li><li><a href="/tech/algorithm/leetcode/greedy-algorithm.html" class="sidebar-link">贪心算法</a></li><li><a href="/tech/algorithm/leetcode/bfs.html" class="sidebar-link">BFS （广度优先遍历）</a></li><li><a href="/tech/algorithm/leetcode/dfs.html" class="sidebar-link">DFS （深度优先遍历）</a></li><li><a href="/tech/algorithm/sort-algorithm/bubble-sort.html" class="sidebar-link">冒泡算法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端监控</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/monitor/monitor/" class="sidebar-link">搭建前端监控系统</a></li><li><a href="/tech/monitor/data-visualization/histogram/" class="sidebar-link">直方图 （Histogram）</a></li><li><a href="/tech/monitor/data-visualization/1/" class="sidebar-link">1. Promethus 介绍</a></li><li><a href="/tech/monitor/data-visualization/2/" class="sidebar-link">2. Exporter 实战详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React Native</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/react-native/webview/" class="sidebar-link">RN Webview 内嵌h5方案调研</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>思考</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/think/2021-06-20.html" class="sidebar-link">抬头看路</a></li><li><a href="/tech/think/2022-02-14.html" class="sidebar-link">被几个月代理leader</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/other/abort-request.html" class="sidebar-link">终止异步任务</a></li><li><a href="/tech/other/cicd-concepts.html" class="sidebar-link">CI/CD 概念</a></li><li><a href="/tech/other/flow-chart.html" class="sidebar-link">流程图规范</a></li><li><a href="/tech/other/google-search.html" class="sidebar-link">google 搜索技巧</a></li><li><a href="/tech/other/how-to-output-log.html" class="sidebar-link">参考资料</a></li><li><a href="/tech/other/linux-command.html" class="sidebar-link">linux 常用命令</a></li><li><a href="/tech/other/sketchup.html" class="sidebar-link">SketchUp 基础入门</a></li><li><a href="/tech/other/docker/docker-introduction/" aria-current="page" class="active sidebar-link">Docker 浅尝辄止</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tech/other/docker/docker-introduction/#docker是什么" class="sidebar-link">Docker是什么</a></li><li class="sidebar-sub-header"><a href="/tech/other/docker/docker-introduction/#如何使用docker" class="sidebar-link">如何使用docker</a></li><li class="sidebar-sub-header"><a href="/tech/other/docker/docker-introduction/#使用docker-compose-打包你的应用" class="sidebar-link">使用docker compose 打包你的应用</a></li><li class="sidebar-sub-header"><a href="/tech/other/docker/docker-introduction/#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/tech/other/docker/docker-introduction/#docker-常用命令总结" class="sidebar-link">Docker 常用命令总结</a></li></ul></li><li><a href="/tech/other/lerna/" class="sidebar-link">lerna 简单入门</a></li><li><a href="/tech/other/npm/" class="sidebar-link">重新认识 npm</a></li><li><a href="/tech/other/svg/" class="sidebar-link">svg 不完全入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>面试</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/interview/handwritten-topic.html" class="sidebar-link">前端手写题</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker-浅尝辄止"><a href="#docker-浅尝辄止" class="header-anchor">#</a> Docker 浅尝辄止</h1> <p>Docker是什么，如何使用Docker，本文结合Docker实践来带着大家了解Docker走入Dokcer的世界。</p> <h2 id="docker是什么"><a href="#docker是什么" class="header-anchor">#</a> Docker是什么</h2> <h3 id="docker概念"><a href="#docker概念" class="header-anchor">#</a> Docker概念</h3> <p><img src="/assets/img/docker-logo.2103c445.png" alt="docker-logo"></p> <p>Docker的logo非常形象的表现了Docker的思想，一艘大船载满各种各样的集装箱。
集装箱解决了什么问题？
船上的货物各种各样，集装箱将各种货物分门别类并且集装箱与集装箱之间互不影响。
这样就不用担心哪些货物不能一起运送的问题。
只要这些货物封装在不同的集装箱里，就可以用一艘大船把它们都运走。</p> <p>回到实际运用中来，服务器就像是一艘大船，Docker就是集装箱。
不同的应用程序会有不同的运行环境依赖，我们把这些环境依赖打包进不同的Docker容器中，容器与容器之间独立存在，互不影响。</p> <p>说到环境隔离这里不得不提到虚拟机技术。虚拟机技术同样可以实现隔离，那它与docker有什么区别呢？</p> <p><img src="/assets/img/docker-vm.92a53412.jpeg" alt="docker-vm"></p> <p>这里对比两者之间的差异，虚拟机通过在操作系统上建立了一个中间虚拟软件层 Hypervisor ，并利用物理机器的资源虚拟出多个虚拟硬件环境来共享宿主机的资源，其中的应用运行在虚拟机内核上。
虚拟机的一个缺点在于Guest OS通常会占用不少硬件资源。
就算不运行任何应用程序也需要占用一定的内存和硬盘空间，而且为了运行程序的性能，往往还要给每台虚拟机预留出一些内存空间以供消耗。</p> <p>相比于虚拟机，Docker省去了虚拟机操作系统（Guest OS），Docker守护进程可以直接与主操作系统进行通信，Docker会直接使用宿主机的硬件资源，为各个Docker容器分配资源，从而节省了一部分的系统资源。</p> <p>对比虚拟机Docker的优缺点：</p> <p><strong>优点：</strong></p> <ul><li>没有虚拟机硬件的初始化，没有Guest OS的启动过程，可以节约很多启动时间；</li> <li>没有运行Guest OS所需的内存开销，无需为虚拟机预留运行内存，无需安装、运行App不需要的运行库/操作系统服务，内存占用、存储空间占用都小的多。</li></ul> <p><strong>缺点：</strong></p> <ul><li>应用之间的隔离不如虚拟机彻底，如果某个应用运行时导致宿主机内核崩溃，所有的容器都会崩溃。</li></ul> <h3 id="docker-架构"><a href="#docker-架构" class="header-anchor">#</a> Docker 架构</h3> <p><img src="/assets/img/docker-architecture.b595b80b.svg" alt="docker-architecture"></p> <p>docker 采用客户端（client）服务器（docker deamon）架构，使用REST API进行通信。</p> <h4 id="docker-镜像-docker-images"><a href="#docker-镜像-docker-images" class="header-anchor">#</a> Docker 镜像（Docker images）</h4> <p>Docker镜像是创建Docker container的只读模版。</p> <h4 id="docker-容器-docker-container"><a href="#docker-容器-docker-container" class="header-anchor">#</a> Docker 容器（Docker container）</h4> <p>container是镜像的可运行实例。</p> <h4 id="docker守护进程-the-docker-da。emon"><a href="#docker守护进程-the-docker-da。emon" class="header-anchor">#</a> Docker守护进程（The Docker da。emon）</h4> <p>Docker守护进程监听Docker Api请求，负责管理docker对象（images、containers、networks、volumes），构建、运行和分发Docker容器。</p> <h4 id="docker客户端-the-docker-client"><a href="#docker客户端-the-docker-client" class="header-anchor">#</a> Docker客户端（The Docker client）</h4> <p>用户通过Docker客户端与Docker守护进程进行交互，用户在命令行中输入Docker命令，Docker客户端将命令发送给Docker守护进程，Docker命令最终会调用Docker API。</p> <h4 id="docker仓库-docker-registries"><a href="#docker仓库-docker-registries" class="header-anchor">#</a> Docker仓库（Docker registries）</h4> <p>Docker仓库存储Docker镜像，默认的仓库地址是<a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，可以配置自己的私有Docker仓库。</p> <h2 id="如何使用docker"><a href="#如何使用docker" class="header-anchor">#</a> 如何使用docker</h2> <p>docker如何安装这里就不讲解了，安装过程可以参考<a href="https://docs.docker.com/get-started/" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="运行第一个docker-container"><a href="#运行第一个docker-container" class="header-anchor">#</a> 运行第一个Docker container</h3> <p>运行一个hello world镜像</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker container run hello-world
</code></pre></div><p><img src="/assets/img/docker-hello-world.689ae47b.png" alt="docker-hello-world"></p> <p>现在我们已经运行了我们的第一个Docker应用，就是这么简单，命令行还打印出生成这条信息Docker用了哪些步骤，这里简单分析一下:</p> <ol><li>首先Docker客户端与Docker守护进程建立通信。</li> <li>Docker会在本地查找hello-world镜像，发现没有找到，此时docker会自动帮我们执行docker pull hello-world 从Docker Hub上拉取，将远程仓库的镜像拉取到本地</li> <li>有了镜像以后Docker守护进程会自动帮我们执行docker container create命令来创建container，并且运行container</li> <li>Docker守护进程将container的运行结果给到Docker客户端，客户端再发送到终端。</li></ol> <h3 id="如何创建image"><a href="#如何创建image" class="header-anchor">#</a> 如何创建image</h3> <p>这里以官方文档中的<a href="https://docs.docker.com/language/nodejs/build-images/" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>讲解如何构建我们自己的镜像</p> <p>首先我们需要创建自己的应用。</p> <ol><li>创建项目</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> node-docker <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> node-docker <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> init -y <span class="token operator">&amp;&amp;</span>  <span class="token function">npm</span> <span class="token function">install</span> ronin-server ronin-mocks <span class="token operator">&amp;&amp;</span> <span class="token function">touch</span> server.js
</code></pre></div><ol start="2"><li>修改server.js</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ronin     <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'ronin-server'</span> <span class="token punctuation">)</span>
<span class="token keyword">const</span> mocks     <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'ronin-mocks'</span> <span class="token punctuation">)</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> ronin<span class="token punctuation">.</span><span class="token function">server</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span> <span class="token string">'/'</span><span class="token punctuation">,</span> mocks<span class="token punctuation">.</span><span class="token function">server</span><span class="token punctuation">(</span> server<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>启动项目</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>$ node server<span class="token punctuation">.</span>js
</code></pre></div><ol start="4"><li>测试一下是否运行正常</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> --request POST <span class="token punctuation">\</span>
  --url http://localhost:8000/test <span class="token punctuation">\</span>
  --header <span class="token string">'content-type: application/json'</span> <span class="token punctuation">\</span>
  --data <span class="token string">'{&quot;msg&quot;: &quot;testing&quot; }'</span>
<span class="token punctuation">{</span><span class="token string">&quot;code&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;success&quot;</span>,<span class="token string">&quot;payload&quot;</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;msg&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;testing&quot;</span>,<span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;31f23305-f5d0-4b4f-a16f-6f4c8ec93cf1&quot;</span>,<span class="token string">&quot;createDate&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2020-08-28T21:53:07.157Z&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

$ <span class="token function">curl</span> http://localhost:8000/test
<span class="token punctuation">{</span><span class="token string">&quot;code&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;success&quot;</span>,<span class="token string">&quot;meta&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;total&quot;</span>:1,<span class="token string">&quot;count&quot;</span>:1<span class="token punctuation">}</span>,<span class="token string">&quot;payload&quot;</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;msg&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;testing&quot;</span>,<span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;31f23305-f5d0-4b4f-a16f-6f4c8ec93cf1&quot;</span>,<span class="token string">&quot;createDate&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2020-08-28T21:53:07.157Z&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

</code></pre></div><p>输出日志：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">2021</span>-05-30T17:39:41:1940  INFO: POST /notes
<span class="token number">2021</span>-05-30T17:40:28:8770  INFO: GET /notes
</code></pre></div><p>说明一切运行正常。</p> <p>现在我们可以开始动手将我们的应用build成一个docker镜像了。</p> <h4 id="创建dockerfile"><a href="#创建dockerfile" class="header-anchor">#</a> 创建Dockerfile</h4> <p>在项目根目录下创建Dockerfile文件，</p> <div class="language-Dockerfile extra-class"><pre class="language-dockerfile"><code>
<span class="token comment"># 基础镜像</span>
<span class="token instruction"><span class="token keyword">FROM</span> node:12.18.1</span>
<span class="token comment"># 指定工作目录，后续所有的操作都在这个目录下进行</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>

<span class="token comment"># 将项目代码拷贝到工作目录</span>
<span class="token instruction"><span class="token keyword">COPY</span> . .</span>

<span class="token comment"># 执行npm install安装所有依赖</span>
<span class="token instruction"><span class="token keyword">RUN</span> npm install</span>

<span class="token comment"># 当镜像的container运行时执行这个命令，这样我们的服务就启动了。</span>
<span class="token comment"># 区别于RUN命令，RUN命令实在生成image时执行的</span>
<span class="token instruction"><span class="token keyword">CMD</span> [ <span class="token string">&quot;node&quot;</span>, <span class="token string">&quot;server.js&quot;</span> ]</span>
</code></pre></div><h4 id="创建-dockerignore"><a href="#创建-dockerignore" class="header-anchor">#</a> 创建.dockerignore</h4> <p>在执行COPY命令的时候我们不希望将node_modules，.git文件拷贝到镜像中来，我们可以创建.dockerignore 将这两个文件加进去。</p> <div class="language-file extra-class"><pre class="language-text"><code>.git
node_modules
</code></pre></div><h4 id="构建镜像"><a href="#构建镜像" class="header-anchor">#</a> 构建镜像</h4> <p>现在所有的准备工作都做好了，我们可以开始构建镜像了。</p> <p>执行命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker build --tag node-docker <span class="token builtin class-name">.</span>
</code></pre></div><p>执行这个命令Docker会读取Dockerfile里面的指令并逐个执行它们，最终创建一个Docker映像。</p> <h4 id="运行container"><a href="#运行container" class="header-anchor">#</a> 运行container</h4> <p>构建好image后我们就可以运行containr了，
执行命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker run -d -p <span class="token number">8000</span>:8000 node-docker
</code></pre></div><ul><li>-d 是--detach的缩写，表示在后台运行container不会占用命令行</li> <li>-p 是--publish缩写，将容器里面的端口暴露给宿主机，[host port]:[container port]</li></ul> <p>执行完这个命令后container已经运行起来了，我们可以用上面的POST和GET请求进行验证。
因为container在后台运行，我们没法直接看到日志打出，可以使用命令  <code>docker logs [containerId]</code> 进行查看。</p> <h4 id="更新应用操作"><a href="#更新应用操作" class="header-anchor">#</a> 更新应用操作</h4> <p>现在我们在server.js加入一行log</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;this is a new image&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
</code></pre></div><p>那么本次改动如何更新到镜像和container中呢？</p> <p>执行以下步骤：</p> <ul><li>重新build image，<code>docker build --tag node-docker .</code></li> <li>删除之前的container，<code>docker rm -f [containerId]</code></li> <li>重新运行container，<code>docker run -dp 8000:8000 node-docker</code></li></ul> <h4 id="共享image"><a href="#共享image" class="header-anchor">#</a> 共享image</h4> <p>镜像构建好了，我们可以发布到远程仓库中以供他人下载和使用。</p> <p>这里我们使用Docker Hub来共享我们image操作步骤如下：</p> <ul><li>首先我们需要<a href="https://www.docker.com/pricing?utm_source=docker&amp;utm_medium=webreferral&amp;utm_campaign=docs_driven_upgrade" target="_blank" rel="noopener noreferrer">注册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和登录Docker Hub；</li> <li>点击 “Create Repository”按钮创建一个自己的仓库，取名就叫node-server，创建成功后得到新的镜像名字，[YOUR-USER-NAME]/node-server；</li> <li>我们需要在本地登录Docker Hub，<code>docker login -u YOUR-USER-NAME</code>；</li> <li>我们需要给镜像重新取一个跟远程一样的名字，<code>docker tag node-serve YOUR-USER-NAME/node-server</code> 这里不会创建新的镜像，执行<code>docker images</code>命令可以看到<code>IMAGE ID</code>是相同的；</li> <li>现在我们可以将镜像推送到远程了，执行命令<code>docker push YOUR-USER-NAME/node-server</code>, 执行完命令刷新Docker Hub页面就可以看到刚刚的推送了。</li></ul> <p>至此别人也可以拉取我们构建好的镜像并运行了。</p> <p>感兴趣的同学可以去<a href="https://labs.play-with-docker.com/" target="_blank" rel="noopener noreferrer">Play with Docker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>拉取并运行刚才发布的镜像。</p> <h4 id="数据持久化-volume"><a href="#数据持久化-volume" class="header-anchor">#</a> 数据持久化（volume）</h4> <p>在上面的demo中，我们用post请求存储的数据存储在container里面的文件系统中。
前文也讲过docker container拥有自己独立的文件系统并且与外界隔离，container可以完成文件的增删改查操作。
当container被删除后，container里面的数据也会被一并删除。
那么docker里面怎么做数据的持久化存储呢。
这里就引入了volume（数据卷）的概念。</p> <p>volume可以将container中的文件路径挂载到宿主机的某个路径上面，
那么container中那个路径下的所有改动都会映射到宿主机上对应的路径中，
它的生命周期独立于容器，
volume不会在容器被删除后自动删除。</p> <p>volume 主要分为两种:</p> <h5 id="_1-bind-mounts"><a href="#_1-bind-mounts" class="header-anchor">#</a> 1. bind mounts</h5> <p>使用bind mounts volume我们需要自己指定挂载目录。
bind mounts volume可以用来做数据存储，不过通常用来给container提供额外的数据，
比如将项目的源代码挂载到container里面，
修改源代码就可以同步到container里面。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker run -dp <span class="token number">8000</span>:8000 <span class="token punctuation">\</span>
     -w /app -v <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>:/app&quot;</span> <span class="token punctuation">\</span>
     node:12-alpine <span class="token punctuation">\</span>
     <span class="token function">sh</span> -c <span class="token string">&quot;npm i nodemon -g &amp;&amp; npm i &amp;&amp; nodemon server.js&quot;</span>
</code></pre></div><p>这样在开发完后我们就可以重新打包我们的镜像了，相当的方便.</p> <h5 id="_2-named-volume"><a href="#_2-named-volume" class="header-anchor">#</a> 2. named volume</h5> <p>named volume适用于数据存储，我们不用关心数据的存储位置。
创建好named volume后，我们只需要使用volumeName用作挂载，
Docker会自动给volume分配存储路径。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 创建named volume </span>
$ docker volume create <span class="token punctuation">[</span>volumeName<span class="token punctuation">]</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code> docker run  -v <span class="token punctuation">[</span>volumeName<span class="token punctuation">]</span>:/etc/todos <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span>
</code></pre></div><p>那我们怎么查看named volume在宿主机上的挂载路径呢，很简单使用命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker volume inspect <span class="token punctuation">[</span>volumeName<span class="token punctuation">]</span>
</code></pre></div><h4 id="container-之间如何通信"><a href="#container-之间如何通信" class="header-anchor">#</a> container 之间如何通信</h4> <p>目前为止我们只有一个container在运行，但是在实际使用中服务往往不止一个，比如数据库服务、api服务等，</p> <p>为了方便管理和维护，我们将服务分到不同的container中运行，力求让每个container只做好一件事情。</p> <p>container之间往往需要相互通信，例如api服务与数据库服务之间需要进行增删改查的通信，那么container直接如何通信呢？</p> <p>这里就要用到docker network了。</p> <p>创建network非常简单:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker network create <span class="token punctuation">[</span>networkName<span class="token punctuation">]</span>
</code></pre></div><p>在同一个局域网中，container之间可以通过networking进行通信。</p> <h4 id="使用volume和network改造我们的应用"><a href="#使用volume和network改造我们的应用" class="header-anchor">#</a> 使用volume和network改造我们的应用</h4> <p>这里我们综合使用volume和networking来改造我们的应用。
我们引入数据库（mongodb）用来存储我们的数据，我们将运行一个mongodb的container。</p> <p>首先创建两个volume用来存储mongodb的数据和配置</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker volume create mongodb
$ docker volume create mongodb_config
</code></pre></div><p>创建一个network用于server和mongodb进行通讯。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker network create mongodb
</code></pre></div><p>好了现在我们可以运行我们的mongodb镜像了，这里我们直接从Docker Hub上拉取
mongodb镜像，将我们创建好的volume挂载上去，同时将mongodb接入到我们创建的network中。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker run --rm -d -v mongodb:/data/db <span class="token punctuation">\</span>
  -v mongodb_config:/data/configdb -p <span class="token number">27017</span>:27017 <span class="token punctuation">\</span>
  --network mongodb <span class="token punctuation">\</span>
  --name mongodb <span class="token punctuation">\</span>
  mongo
</code></pre></div><p>修改我们的server.js代码，使其连接到mongodb服务。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ronin     <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'ronin-server'</span> <span class="token punctuation">)</span>
<span class="token keyword">const</span> mocks     <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'ronin-mocks'</span> <span class="token punctuation">)</span>
<span class="token keyword">const</span> database  <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'ronin-database'</span> <span class="token punctuation">)</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> ronin<span class="token punctuation">.</span><span class="token function">server</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

database<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CONNECTIONSTRING</span> <span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span> <span class="token string">'/'</span><span class="token punctuation">,</span> mocks<span class="token punctuation">.</span><span class="token function">server</span><span class="token punctuation">(</span> server<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>这里引入了ronin-database需要安装</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> ronin-database
</code></pre></div><p>现在重新编译我们镜像：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker build --tag node-docker <span class="token builtin class-name">.</span>
</code></pre></div><p>镜像编译完成就可以运行我们的container了</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker run <span class="token punctuation">\</span>
  --rm -d <span class="token punctuation">\</span>
  --network mongodb <span class="token punctuation">\</span>
  --name rest-server <span class="token punctuation">\</span>
  -p <span class="token number">8000</span>:8000 <span class="token punctuation">\</span>
  -e <span class="token assign-left variable">CONNECTIONSTRING</span><span class="token operator">=</span>mongodb://mongodb:27017/db_notes <span class="token punctuation">\</span>
  node-docker
</code></pre></div><p>我们将node-docker container接入到相同的网络mongodb中，这样node-docker就可以和mongodb相互通信了。
这里注入环境变量CONNECTIONSTRING，server.js连接数据库需要用到。</p> <p>现在让我们来测试一下：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> --request POST <span class="token punctuation">\</span>
  --url http://localhost:8000/notes <span class="token punctuation">\</span>
  --header <span class="token string">'content-type: application/json'</span> <span class="token punctuation">\</span>
  --data <span class="token string">'{
&quot;name&quot;: &quot;this is a note&quot;,
&quot;text&quot;: &quot;this is a note that I wanted to take while I was working on writing a blog post.&quot;,
&quot;owner&quot;: &quot;peter&quot;
}'</span>
</code></pre></div><p>获取一下我们刚才存储的数据</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> --request GET --url http://localhost:8000/notes
</code></pre></div><p>大功告成。后面就算将mongodb的container删除，只要在启动的时候将volume挂载上去，数据还是一直存在的。</p> <h2 id="使用docker-compose-打包你的应用"><a href="#使用docker-compose-打包你的应用" class="header-anchor">#</a> 使用docker compose 打包你的应用</h2> <p>到目前为止我们已经了解了docker的基本概念，学会了如何使用docker。</p> <p>但是我们也发现了，整个过程还是比较繁琐的，我们需要创建network，创建volume，启动container，注入环境变量等等操作。</p> <p>有没有办法一行命令搞定所有这些事情呢？答案是肯定的。现在我们就来介绍docker compose的使用让我们一次搞定。</p> <p>docker compose需要安装。这里我们省略安装步骤，大家自行google。</p> <ol><li>在项目的根目录下创建docker-compose.yml文件</li> <li>写入相关命令</li></ol> <div class="language- extra-class"><pre class="language-text"><code>version: '3.3'

services:
 notes:
  build:
   context: .
  ports:
   - 8000:8000
  environment:
   - SERVER_PORT=8000
   - CONNECTIONSTRING=mongodb://mongo:27017/notes
  working_dir: /app
  volumes:
   - ./:/app
  command: npm run start

 mongo:
  image: mongo:4.2.8
  ports:
   - 27017:27017
  volumes:
   - mongodb:/data/db
   - mongodb_config:/data/configdb
volumes:
 mongodb:
 mongodb_config:
</code></pre></div><p>定义好docker-compose.yml文件文件以后使用命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker-compose up -d
</code></pre></div><p>查看日志</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker-compose logs -f
</code></pre></div><p>查看某个日志</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker-compose logs -f app
</code></pre></div><p>停止</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker-compose down
</code></pre></div><h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>最后我们来总结一下Docker的特点：</p> <ul><li>高效利用系统资源
由于容器不需要进行硬件虚拟以及运行完整操作系统等额外开销，Docker 对系统资源的利用率更高。</li> <li>启动时间短
Docker运行于宿主机内核之中，相较于虚拟机无需启动完整的操作系统，启动时间往往是秒甚至毫秒级别。</li> <li>保证了运行环境的一致性
Dokcer将服务所需的依赖都打包进image中，保证了在不同机器上运行环境的一致性，不会出现因为运行环境不一致导致的bug</li> <li>方便迁移
由于Dokcer保证了运行环境的一致性，不同平台运行Docker得出的结果都是一致的，这样用户就可以很轻易的将一个平台上运行的应用，迁移到另一个平台上。</li></ul> <p>对于普通的应用docker + docker compose完全可以应付。</p> <p>面临的问题：</p> <p>随着容器数量的不断增长</p> <ul><li>如何协调和调度这些容器？</li> <li>如何在版本更新的时候不中断服务？</li> <li>如何监视应用程序的运行情况？</li> <li>如何批量操作容器？</li></ul> <p>随着这些问题的出现，演变出了容器编排技术，Kubernetes（k8s）、Docker Swarm等，用来管理容器</p> <h2 id="docker-常用命令总结"><a href="#docker-常用命令总结" class="header-anchor">#</a> Docker 常用命令总结</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 查看所有运行中的container</span>
$ docker <span class="token function">ps</span> 
<span class="token comment"># 查看所有container</span>
$ docker <span class="token function">ps</span> -a
<span class="token comment"># 停止所有容器</span>
$ docker stop <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -aq<span class="token variable">)</span></span>
<span class="token comment"># 删除所有容器</span>
$ docker <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -aq<span class="token variable">)</span></span>
<span class="token comment"># 删除所有镜像</span>
$ docker rmi <span class="token variable"><span class="token variable">$(</span>docker images -q<span class="token variable">)</span></span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tech/other/sketchup.html" class="prev">
        SketchUp 基础入门
      </a></span> <span class="next"><a href="/tech/other/lerna/">
        lerna 简单入门
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.20c2ee50.js" defer></script><script src="/assets/js/2.c1155b6d.js" defer></script><script src="/assets/js/10.c7c7f8ce.js" defer></script>
  </body>
</html>
